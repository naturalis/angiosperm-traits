---
title: "Model_selection_woody"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Model selection derived woodiness

The linear model will have to be made, with the trait-presence-column as the dependent variable, and the 
GIS data frames as the predictor variables. The function phylostep of the phylolm package will be used. 

## Results VIF analysis

```{r VIF analysis}
# 1. Without ClimaticMoistureIndex: 
vif(GIS_woody[,c(3:5, 14, 15, 17, 18, 20, 22:24, 38, 39, 42, 43)])

# 2. With ClimaticMoistureIndex:
vif(GIS_woody[,c(3:5, 8, 14, 17, 18, 20, 22:24, 39, 43)])

# 3. With BIO6, without ClimaticMoistureIndex:
vif(GIS_woody[,c(3:5, 14, 15, 17, 20, 22:24, 30, 38, 39, 42, 43)]) 

# 4. With BIO6, with ClimaticMoistureIndex:
vif(GIS_woody[,c(3:5, 8, 14, 17, 20, 22:24, 30, 39, 43)]) 
```

## Define formulas

```{r define formula}
# 0. Define starting formula
woody_starting_formula <- woody ~ 1 

# 1. Without ClimaticMoistureIndex: 
woody_formula_1 <- GIS_woody$woody ~ GIS_woody$Aspect + GIS_woody$BulkDensity + GIS_woody$ClayPercentage + GIS_woody$minTempWarmest + GIS_woody$monthCountByTemp10 + GIS_woody$PETDriestQuarter + GIS_woody$PETseasonality + GIS_woody$PETWettestQuarter + GIS_woody$OrganicCarbon + GIS_woody$PhCaCL + GIS_woody$Slope + GIS_woody$bio14 + GIS_woody$bio15 + GIS_woody$bio18 + GIS_woody$bio19


'woody' ~ GIS_woody[c('Aspect' + 'BulkDensity' + 'ClayPercentage' + 'minTempWarmest' + 'monthCountByTemp10' + 'PETDriestQuarter' + 'PETseasonality' + 'PETWettestQuarter' + 'OrganicCarbon' + 'PhCaCl' + 'Slope' + 'BIO14' + 'BIO15' + 'BIO18' + 'BIO19'),]

# 2. With ClimaticMoistureIndex:
woody_formula_2 <- 'woody' ~ 'Aspect' + 'BulkDensity' + 'ClayPercentage' + 'ClimaticMoistureIndex' +'minTempWarmest' + 'PETDriestQuarter' + 'PETseasonality' + 'PETWettestQuarter' + 'OrganicCarbon' + 'PhCaCl' + 'Slope' + 'BIO15' + 'BIO19'

# 3. With BIO6, without ClimaticMoistureIndex:
woody_formula_3 <- 'woody' ~ 'Aspect' + 'BulkDensity' + 'ClayPercentage' + 'minTempWarmest' + 'monthCountByTemp10' + 'PETDriestQuarter' + 'PETWettestQuarter' + 'OrganicCarbon' + 'PhCaCl' + 'Slope' + 'BIO6' + 'BIO14' + 'BIO15' + 'BIO18' + 'BIO19'

# 4. With BIO6, with ClimaticMoistureIndex:
woody_formula_4 <- 'woody' ~ 'Aspect' + 'BulkDensity' + 'ClayPercentage' + 'ClimaticMoistureIndex' + 'minTempWarmest' + 'PETDriestQuarter' + 'PETWettestQuarter' + 'OrganicCarbon' + 'PhCaCl' + 'Slope' + 'BIO6' + 'BIO15' + 'BIO19'

```

## Model selection with BM 

BM stands for ...

```{r model selection BM}
#load required package
library(phylolm)

#define formula components and run function (forward)
##1
phylostep(formula = woody_formula_1, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "forward", trace = 2)
##2
phylostep(formula = , starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "forward", trace = 2)
##3
phylostep(formula = , starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "forward", trace = 2)
##4
phylostep(formula = , starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "forward", trace = 2)

#define formula components and run function (both)
##1
phylostep(formula = , starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "both", trace = 2)
##2
phylostep(formula = , starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "both", trace = 2)
##3
phylostep(formula = , starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "both", trace = 2)
##4
phylostep(formula = , starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "BM", direction = "both", trace = 2)

```

The forward model with BM has the following model as the best model, with an AIC of...
  woody ~
The both model with BM has the following model as the best model, with an AIC of ...
  woody ~

## Model selection with OUrandomRoot

OUrandomRoot stands for.. 

```{r model selection OUrandomRoot}
#define formula components and run function (forward)
## 1
phylostep(formula = woody_formula_1, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "forward", trace = 2)
## 2
phylostep(formula = woody_formula_2, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "forward", trace = 2)
## 3
phylostep(formula = woody_formula_3, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "forward", trace = 2)
## 4
phylostep(formula = woody_formula_4, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "forward", trace = 2)

#define formula components and run function (both)
## 1
phylostep(formula = woody_formula_1, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "both", trace = 2)
## 2
phylostep(formula = woody_formula_2, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "both", trace = 2)
## 3
phylostep(formula = woody_formula_3, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "both", trace = 2)
## 4
phylostep(formula = woody_formula_4, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUrandomRoot", direction = "both", trace = 2)

```

The forward model with OUrandomRoot has the following model as the best model, with an AIC of...
  woody ~
The both model with OUrandomRoot has the following model as the best model, with an AIC of ...
  woody ~

## Model selection with OUfixedRoot

OUfixedRoot stands for.. 

```{r model selection OUfixedRoot}
#define formula components and run function (forward)
## 1
phylostep(formula = woody_formula_1, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "forward", trace = 2)
## 2
phylostep(formula = woody_formula_2, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "forward", trace = 2)
## 3
phylostep(formula = woody_formula_3, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "forward", trace = 2)
## 4
phylostep(formula = woody_formula_4, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "forward", trace = 2)

#define formula components and run function (both)
## 1
phylostep(formula = woody_formula_1, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "both", trace = 2)
## 2
phylostep(formula = woody_formula_2, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "both", trace = 2)
## 3
phylostep(formula = woody_formula_3, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "both", trace = 2)
## 4
phylostep(formula = woody_formula_4, starting.formula = woody_starting_formula, data = GIS_woody, phy = tree_woody, model = "OUfixedRoot", direction = "both", trace = 2)
```

The forward model with OUfixedRoot has the following model as the best model, with an AIC of...
  woody ~
The both model with OUfixedRoot has the following model as the best model, with an AIC of ...
  woody ~

