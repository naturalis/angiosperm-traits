---
title: "Model_selection_crops"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Model selection domestication

The linear model will have to be made, with the trait-presence-column as the dependent variable, and the 
GIS data frames as the predictor variables. The function phylostep of the phylolm package will be used. 

## Results of VIF-analysis
```{r}
# 1. 


# 2. 

```

## Change data to match the wanted data format

There are some flaws in the GIS data frame that make it unfit for the phylostep function. First of all
the row names have to match the tip.lables of the tree, and secondly the trait value (0/1) has to be
seen as a numeric value. 
```{r}
#make allmb_name column into the row names of this table
rownames(GIS_crops) <- GIS_crops[,1]
GIS_crops[,1] <- NULL

#make sure the values in the 'woody' column are seen as numeric values
GIS_crops$domestication <- as.numeric(GIS_crops$domestication)
#check whether it worked
is.numeric(GIS_crops$domestication)
```

## Define formulas
```{r}
# 0. Starting formula
crops_starting_formula <- domestication ~ 1 

# 1. 
crops_formula_1 <- domestication ~ 

# 2. 
crops_formula_2 <- domestication ~ 
```

## Model selection with BM

```{r model selection BM}
#load required package
library(phylolm)

#define formula components and run function (forward)
## 1
phylostep(formula = crops_formula_1, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "BM", direction = "forward", trace = 2)
## 2
phylostep(formula = crops_formula_2, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "BM", direction = "forward", trace = 2)

#define formula components and run function (both)
## 1
phylostep(formula = crops_formula_1, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "BM", direction = "both", trace = 2)
## 2
phylostep(formula = crops_formula_1, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "BM", direction = "both", trace = 2)
```

The forward model with BM has the following model as the best model, with an AIC of...
  domestication ~
The both model with BM has the following model as the best model, with an AIC of ...
  domestication ~

## Model selection with OUrandomRoot

```{r model selection OUrandomRoot}
#define formula components and run function (forward)
## 1
phylostep(formula = crops_formula_1, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUrandomRoot", direction = "forward", trace = 2)
## 2
phylostep(formula = crops_formula_2, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUrandomRoot", direction = "forward", trace = 2)

#define formula components and run function (both)
## 1
phylostep(formula = crops_formula_1, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUrandomRoot", direction = "both", trace = 2)
## 2
phylostep(formula = crops_formula_2, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUrandomRoot", direction = "both", trace = 2)
```

The forward model with OUrandomRoot has the following model as the best model, with an AIC of...
  domestication ~
The both model with OUrandomRoot has the following model as the best model, with an AIC of ...
  domestication ~

## Model selection with OUfixedRoot

```{r model selection OUfixedRoot}
#define formula components and run function (forward)
## 1
phylostep(formula = crops_formula_1, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUfixedRoot", direction = "forward", trace = 2)
## 2
phylostep(formula = crops_formula_2, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUfixedRoot", direction = "forward", trace = 2)

#define formula components and run function (both)
## 1
phylostep(formula = crops_formula_1, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUfixedRoot", direction = "both", trace = 2)
## 2
phylostep(formula = crops_formula_2, starting.formula = crops_starting_formula, data = GIS_crops, phy = tree_crops, model = "OUfixedRoot", direction = "both", trace = 2)
```

The forward model with OUfixedRoot has the following model as the best model, with an AIC of...
  domestication ~
The both model with OUfixedRoot has the following model as the best model, with an AIC of ...
  domestication ~

## Conclusion
The best model can be made with the following combination:
Formula: 
Model: 
Direction: 